#######################################################################
# input.conf
# 设备配置：Keychron Q10 Alice + Keychron Q0 小键盘 + 罗技 GPW + 雷蛇毒奎
# 生效：hyprctl reload
#######################################################################

#####################
# 🎹 全局输入设置
#####################
input {
    # === 键盘布局（Colemak）===
    kb_layout  = us
    kb_variant =                # Colemak 布局
    kb_model   =
    kb_options =            # Caps Lock → Ctrl
    # 其他选项：
    # kb_options = caps:escape         # Caps → Esc（Vim 用户）
    # kb_options = ctrl:nocaps,compose:ralt  # 组合键
    kb_rules   =
    
    # === 按键重复速率（编程/打字优化）===
    repeat_rate  = 50                  # 50 字符/秒
    repeat_delay = 280                 # 280ms 开始重复
    numlock_by_default = true          # Q0 小键盘默认开启
    
    # === 鼠标焦点（多设备优化）===
    follow_mouse = 1                   # 鼠标移动即聚焦
    float_switch_override_focus = 2    # 浮动窗口优先
    mouse_refocus = true               # 鼠标移动重新聚焦
    
    # === 鼠标加速（游戏鼠标禁用）===
    sensitivity = 0.0                  # 全局不修改
    accel_profile = flat               # 无加速（游戏标准）
    force_no_accel = false
    
    # === 其他设置 ===
    left_handed = false
    scroll_method = on_button_down     # 按钮滚动（适合游戏鼠标）
    scroll_button = 0
    scroll_button_lock = false
    
    # === 触控板（台式机无需，保留配置）===
    touchpad {
        natural_scroll = true
        disable_while_typing = true
        tap-to-click = true
        tap-and-drag = true
        drag_lock = false
        clickfinger_behavior = false
        middle_button_emulation = false
        scroll_factor = 1.0
    }
}

#####################
# ⌨️ Keychron Q10 Alice（主键盘）
#####################
device {
    name = keychron-keychron-q10-keyboard
    enabled = true
    
    # === Colemak 布局 ===
    kb_layout = us
    kb_variant = 
    kb_options =            # Caps → Ctrl（Alice 布局推荐）
    
    # === 重复速率 ===
    repeat_rate = 50
    repeat_delay = 280
    numlock_by_default = true
}

# Q10 的其他虚拟设备（保持默认，无需特殊配置）
device {
    name = keychron-keychron-q10
    enabled = true
}

device {
    name = keychron-keychron-q10-system-control
    enabled = true
}

device {
    name = keychron-keychron-q10-consumer-control
    enabled = true
}

#####################
# 🔢 Keychron Q0（小键盘）
#####################
device {
    name = keychron-keychron-q0-keyboard
    enabled = true
    
    # 小键盘无需 Colemak，保持标准布局
    kb_layout = us
    kb_variant =
    numlock_by_default = true          # 默认开启数字模式
}

# Q0 的其他虚拟设备
device {
    name = keychron-keychron-q0
    enabled = true
}

device {
    name = keychron-keychron-q0-system-control
    enabled = true
}

device {
    name = keychron-keychron-q0-consumer-control
    enabled = true
}

#####################
# 🖱️ 罗技 G Pro Wireless（GPW）
#####################
device {
    name = logitech-usb-receiver
    enabled = true
    
    # === 游戏鼠标专用设置 ===
    sensitivity = 0.0                  # 不修改（在 logiops 中设置 DPI）
    accel_profile = flat               # 无加速（游戏必须）
    scroll_method = on_button_down     # 按钮滚动
    natural_scroll = false             # 传统滚动方向
    left_handed = false
    middle_button_emulation = false
}

# GPW 的虚拟键盘设备（鼠标按键/滚轮映射）
device {
    name = logitech-usb-receiver-keyboard
    enabled = true
}

device {
    name = logitech-usb-receiver-keyboard-1
    enabled = true
}

#####################
# 🐍 雷蛇毒奎 Viper Ultimate
#####################
device {
    name = razer-razer-viper-ultimate-dongle
    enabled = true
    
    # === 游戏鼠标专用设置 ===
    sensitivity = 0.0                  # 不修改（在 OpenRazer 中设置 DPI）
    accel_profile = flat               # 无加速（游戏必须）
    scroll_method = on_button_down     # 按钮滚动
    natural_scroll = false             # 传统滚动方向
    left_handed = false
    middle_button_emulation = false
}

# 毒奎的虚拟键盘设备
device {
    name = razer-razer-viper-ultimate-dongle-keyboard
    enabled = true
}

device {
    name = razer-razer-viper-ultimate-dongle-keyboard-1
    enabled = true
}

device {
    name = razer-razer-viper-ultimate-dongle-1
    enabled = true
}

#####################
# 🪫 雷蛇鼠标底座（Mouse Dock）
#####################
device {
    name = razer-razer-mouse-dock
    enabled = true
    
    # 底座通常无需特殊配置，保持默认
    sensitivity = 0.0
    accel_profile = flat
}

device {
    name = razer-razer-mouse-dock-keyboard
    enabled = true
}

device {
    name = razer-razer-mouse-dock-keyboard-1
    enabled = true
}

device {
    name = razer-razer-mouse-dock-1
    enabled = true
}

#####################
# 🎧 HyperX Cloud Core Wireless（耳机控制器）
#####################
device {
    name = kingston-hyperx-cloud-core-wireless-consumer-control
    enabled = true
    # 耳机的媒体按键，保持默认
}

device {
    name = kingston-hyperx-virtual-surround-sound-consumer-control
    enabled = true
}

device {
    name = kingston-hyperx-virtual-surround-sound
    enabled = true
}

#####################
# 💬 Fcitx5 虚拟键盘
#####################
device {
    name = hl-virtual-keyboard-fcitx5
    enabled = true
    # 输入法虚拟键盘，保持默认
}

#####################
# 🔘 系统按键（电源/睡眠）
#####################
device {
    name = power-button
    enabled = true
}

device {
    name = power-button-1
    enabled = true
}

device {
    name = sleep-button
    enabled = true
}

#######################################################################
# 📋 设备说明
#######################################################################
# 
# 🎹 键盘：
#   - Keychron Q10 Alice（主键盘） → Colemak 布局
#   - Keychron Q0（独立小键盘）   → 标准布局
#
# 🖱️ 鼠标：
#   - 罗技 G Pro Wireless（logitech-usb-receiver）
#   - 雷蛇毒奎 Viper Ultimate（razer-razer-viper-ultimate-dongle）
#   - 雷蛇鼠标充电底座（razer-razer-mouse-dock）
#
# 🎧 音频：
#   - HyperX Cloud Core Wireless（媒体按键控制）
#
# 💬 输入法：
#   - Fcitx5 虚拟键盘（用于输入法候选框等）
#
#######################################################################

#######################################################################
# 🎮 鼠标 DPI 设置（在各自软件中配置）
#######################################################################
#
# === 罗技 GPW ===
# 方法1：logiops（推荐，开源）
#   安装：yay -S logiops-git
#   配置：/etc/logid.cfg
#   示例：
#     devices: ({
#       name: "Logitech USB Receiver";
#       dpi: 1600;
#     });
#   启动：sudo systemctl enable --now logid
#
# 方法2：Piper（GUI）
#   安装：sudo pacman -S piper
#   运行：piper
#
# === 雷蛇毒奎 ===
# 方法1：OpenRazer + Polychromatic（推荐）
#   安装：sudo pacman -S openrazer-meta python-pyqt5
#         yay -S polychromatic
#   添加用户组：sudo gpasswd -a $USER plugdev
#   启动：sudo systemctl enable --now openrazer-daemon
#   GUI：polychromatic-controller
#
# 方法2：razercfg（命令行）
#   安装：yay -S razercfg
#   设置DPI：razer-cli -d "Razer Viper Ultimate" -s 1600
#   设置灯效：razer-cli -e static -c 00FF00
#
#######################################################################

#######################################################################
# 🔧 Colemak 布局说明
#######################################################################
#
# QWERTY → Colemak 键位映射：
#   Q W E R T Y U I O P     Q W F P G J L U Y ;
#   A S D F G H J K L ;  →  A R S T D H N E I O
#   Z X C V B N M           Z X C V B K M
#
# 你的方向键（keymaps.conf 中的 n/i/u/e）：
#   n = 左（QWERTY-J 位置，Colemak-N）
#   i = 右（QWERTY-L 位置，Colemak-I）
#   u = 上（QWERTY-I 位置，Colemak-U）
#   e = 下（QWERTY-K 位置，Colemak-E）
#
# 这个映射完美适配 Colemak 的字母逻辑！
#
#######################################################################

#######################################################################
# 🔍 调试命令
#######################################################################
#
# 查看设备列表：
#   hyprctl devices
#
# 查看当前配置：
#   hyprctl getoption input -j | jq
#   hyprctl getoption device:keychron-keychron-q10-keyboard -j | jq
#
# 实时监控输入事件：
#   wev
#
# 测试 Colemak 布局：
#   打开文本编辑器，按 QWERTY 的 E 键，应该输出 F
#
# 测试键盘重复：
#   按住任意字母键，观察重复速度
#
# 测试鼠标加速：
#   快速移动鼠标，观察光标移动是否均匀（应该均匀=无加速）
#
# 重载配置：
#   hyprctl reload
#
#######################################################################

#######################################################################
# 💡 优化建议
#######################################################################
#
# 1. Caps Lock 改键（Alice 布局推荐）：
#    当前：ctrl:nocaps（Caps → Ctrl）
#    替代：caps:escape（Caps → Esc，Vim 用户）
#    替代：caps:backspace（Caps → Backspace，减少小指负担）
#
# 2. 按键重复速率调整：
#    当前：repeat_rate=50, repeat_delay=280
#    更快：repeat_rate=60, repeat_delay=250（代码补全更快）
#    更慢：repeat_rate=40, repeat_delay=350（避免误触）
#
# 3. 小键盘独立快捷键（keymaps.conf）：
#    bind = $mainMod, KP_0, exec, 计算器
#    bind = $mainMod, KP_Enter, exec, 特定命令
#
# 4. 鼠标快速切换（keymaps.conf）：
#    bind = $suprMod, M, exec, hyprctl switchxkblayout next
#    或创建脚本在 GPW 和毒奎之间切换 DPI 配置
#
# 5. 游戏模式（禁用输入法、降低重复延迟）：
#    创建 gaming-mode.conf，在需要时 source
#
#######################################################################
