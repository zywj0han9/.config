# ===================================================================
#  基础核心配置 (Base Configuration) - v2 (已修正)
#  ~/.config/tmux/conf.d/base.conf
# ===================================================================
#
#  职责:
#  - 设置基础运行参数和行为.
#  - 定义非键位、非外观的核心功能.
#
#  变更:
#  - 移除了在新版 Tmux 中已废弃的 `status-utf8` 和 `utf8` 选项.
#

# -------------------------------------------------------------------
# 1. 核心行为 (Core Behavior)
# -------------------------------------------------------------------

# 设置默认前缀为 Ctrl-b.
set -g prefix C-b

# 降低 Esc 键的响应延迟, 对 Vim/Neovim 用户非常重要.
set -sg escape-time 10

# 窗口和面板的索引从 1 开始, 更符合直觉.
set -g base-index 1
setw -g pane-base-index 1

# 切换窗口或面板后, 自动重命名窗口以反映当前进程.
setw -g automatic-rename on
# 但禁止 tmux 过于频繁地自动重命名, 避免干扰.
set -g allow-rename off

# 会话意外断开 (如关闭终端模拟器) 后, 依然在后台保持运行.
set -g detach-on-destroy off

# -------------------------------------------------------------------
# 2. 终端兼容性 (Terminal Compatibility)
# -------------------------------------------------------------------

# 设置默认终端类型, 并启用 24-bit 真彩色 (True Color).
# 确保您的终端模拟器也支持真彩色 (如 Alacritty, Kitty, WezTerm).
set -g default-terminal "tmux-256color"
set -as terminal-overrides ",xterm*:RGB"
set -as terminal-overrides ",alacritty:RGB"
set -as terminal-overrides ",kitty:RGB"
set -as terminal-overrides ",wezterm:RGB"

# -------------------------------------------------------------------
# 3. 历史与缓冲区 (History & Buffers)
# -------------------------------------------------------------------

# 增加回滚历史记录的行数 (默认为 2000).
set -g history-limit 100000

# -------------------------------------------------------------------
# 4. 鼠标支持 (Mouse Support)
# -------------------------------------------------------------------

# 启用完整的鼠标支持: 点击选择窗口/面板, 拖动调整大小, 滚轮滚动.
set -g mouse on

# -------------------------------------------------------------------
# 5. 键盘与输入 (Keyboard & Input)  <-- 新增部分
# -------------------------------------------------------------------
# 允许终端将 Option/Alt 键作为 Meta 键发送.
set -g xterm-keys on

# -------------------------------------------------------------------
# 6. 通知与监控 (Notifications & Monitoring)
# -------------------------------------------------------------------

# 当非活动窗口有内容更新时, 在状态栏通知.
setw -g monitor-activity on

# 移除视觉提示音 (闪烁), 因为有 monitor-activity 就够了.
set -g visual-bell off
set -g bell-action none

